{% extends "layout.html" %}

{% set active_page = "gallery" %}

{% macro gallery_image_card(image) %}
  <div class="gallery-item">
    <a href="/static/uploads/profilepictures/{{ image.filename }}">
      <img class="gallery-image" src="/static/uploads/profilepictures/{{ image.filename }}" alt="{{image.filename}}">
    </a>
    <div class="gallery-image-description">
        <a href="/profile/{{ image.user.id }}">{{ image.user.full_name }}</a>,
        {{_('Uppladdad')}}: {{ image.timestamp.strftime('%d %b %Y ') }}
    </div>
  </div>
{% endmacro %}

{% macro gallery_paginator_item(text, pagenum, active) %}
<div class="gallery-paginator-item {% if active %}active{% endif %}">
    {% if active %}
      <a href="/gallery/{{pagenum}}">{{text}}</a>
    {% else %}
      {{text}}
    {% endif %}
  </div>
{% endmacro %}

{% macro gallery_paginator() %}
  <div class="gallery-paginator">
    {{ gallery_paginator_item('<<', 1, has_prev) }}
    {{ gallery_paginator_item('<', page - 1, has_prev) }}

    {% if has_prev %}
      {% for p in range(page-2, page) %}
      {% if p >= 1 %}
          {{ gallery_paginator_item(p, p, True) }}
        {% endif %}
      {% endfor %}
    {% endif %}

    {{ gallery_paginator_item(page, page, False) }}

    {% if has_next %}
      {% for p in range(page+1, page+3) %}
        {% if p <= last_page %}
          {{ gallery_paginator_item(p, p, True) }}
        {% endif %}
      {% endfor %}
    {% endif %}

    {{ gallery_paginator_item('>', page + 1, has_next) }}
    {{ gallery_paginator_item('>>', last_page, has_next) }}
  </div>
{% endmacro %}


{% block body %}
<h2>{{_('Profilbilder genom tiderna')}}</h2>
{{ gallery_paginator() }}
  {% for image in images %}
    {{ gallery_image_card(image) }}
  {% endfor %}
{{ gallery_paginator() }}

{% endblock %}
